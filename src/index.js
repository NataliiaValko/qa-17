// # ÐœÐ¾Ð´ÑƒÐ»ÑŒ 10. Ð—Ð°Ð½ÑÑ‚Ñ‚Ñ 9

//Ð—ÐÐ”ÐÐ§Ð 1
// ÐÐ°Ð¿Ð¸ÑˆÐ¸ Ñ„Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´ Ñ‡Ð°ÑÑ‚Ð¸Ð½Ñƒ Ð·Ð°ÑÑ‚Ð¾ÑÑƒÐ½ÐºÑƒ Ð´Ð»Ñ Ð¿Ð¾ÑˆÑƒÐºÑƒ Ñ‚Ð¾Ð²Ð°Ñ€Ñ–Ð² Ð¿Ð¾ ÑÐ»Ð¾Ð²Ñƒ Ð² Ð½Ð°Ð·Ð²Ñ–, Ð¾Ð¿Ð¸ÑÑ– Ñ‚Ð¾Ñ‰Ð¾. Ð’Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÐ¹ ÐÐ Ð†
// https://dummyjson.com/
// Ð’Ð·Ð°Ñ”Ð¼Ð¾Ð´Ñ–ÑŽ Ð· Ð±ÐµÐºÐµÐ½Ð´Ð¾Ð¼ Ð¾Ð¿Ð¸ÑˆÐ¸ Ñƒ Ñ„Ð°Ð¹Ð»Ñ– apiDummyJSON.js
// Ð—Ñ€Ð¾Ð±Ð¸ Ñ„Ñ–Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ñ–ÑŽ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ–Ð² Ñƒ Ð·Ð°Ð¿Ð¸Ñ‚Ñ–, Ñ‚ÐµÐ±Ðµ Ñ†Ñ–ÐºÐ°Ð²Ð»ÑÑ‚ÑŒ Ð½Ð°ÑÑ‚ÑƒÐ¿Ð½Ñ– Ð¿Ð¾Ð»Ñ: title, price, description, brand, images, rating.
// Ð—Ð½Ð°Ñ‡ÐµÐ½Ð½Ñ Ð´Ð»Ñ Ð¿Ð¾ÑˆÑƒÐºÑƒ Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ð¹ Ð· Ñ„Ð¾Ñ€Ð¼Ð¸ Ð¿Ñ–ÑÐ»Ñ Ð½Ð°Ñ‚Ð¸ÑÐºÐ°Ð½Ð½Ñ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ "Search".
// Ð¯ÐºÑ‰Ð¾ Ñƒ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´ÑŒ Ð²Ñ–Ð´ Ð±ÐµÐºÐµÐ½Ð´Ð° Ð¿Ñ€Ð¸Ð¹ÑˆÐ»Ð¾ Ð±Ñ–Ð»ÑŒÑˆÐµ 4Ñ… Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ñ–Ð², Ñ‚Ð¾ Ð´Ð¾Ð´Ð°Ð¹ Ñƒ Ñ–Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ñ€Ð¾Ð·Ð¼Ñ–Ñ‚ÐºÑƒ ÑÐ¿Ð¸ÑÐºÑƒ, ÑÐºÐ° Ð±ÑƒÐ´Ðµ ÑÐºÐ»Ð°Ð´Ð°Ñ‚Ð¸ÑÑŒ Ñ–Ð· Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð½Ñ Ñ– Ð½Ð°Ð·Ð²Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°. Ð¯ÐºÑ‰Ð¾ 2 Ñ– Ð¼ÐµÐ½ÑˆÐµ, Ñ‚Ð¾ ÑÐ¿Ð¸ÑÐ¾Ðº ÐºÐ°Ñ€Ñ‚Ð¾Ðº Ð· Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾ÑŽ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ”ÑŽ Ð¿Ð¾ ÐºÐ¾Ð¶Ð½Ð¾Ð¼Ñƒ Ñ‚Ð¾Ð²Ð°Ñ€Ñƒ.
// ÐÐµ Ð·Ð°Ð±ÑƒÐ´ÑŒ Ð¾Ð±Ñ€Ð¾Ð±Ð¸Ñ‚Ð¸ Ð¼Ð¾Ð¶Ð»Ð¸Ð²Ñ– Ð¿Ð¾Ð¼Ð¸Ð»ÐºÐ¸ ðŸ˜‰
//(Product matching these criteria was not found, please try changing your search)

import { Notify } from 'notiflix';
import { fetchProductsByQuery } from './js/apiDummyJSON';
import { createMarkupBigCard, createMarkupLittleCard } from './js/markup';

const searchFormRef = document.querySelector('#searchForm');
const productsListRef = document.querySelector('.productsList');
const searchFormInputRef = document.querySelector('.searchForm-input');
const searchFormButtonRef = document.querySelector('.searchForm-button');

searchFormInputRef.addEventListener('input', onSearchFormInput);
searchFormRef.addEventListener('submit', onSearchFormSubmit);

searchFormButtonRef.disabled = true;

async function onSearchFormSubmit(event) {
  event.preventDefault();
  const query = event.target.elements.searchValue.value.toLowerCase().trim();
  if (!query) {
    return;
  }

  try {
    const { products } = await fetchProductsByQuery(query);
    event.target.reset();
    if (!products.length) {
      Notify.failure(
        'Product matching these criteria was not found, please try changing your search'
      );
      productsListRef.innerHTML = '';
      return;
    }

    if (products.length > 2) {
      Notify.success(`We found ${products.length} products`);
      productsListRef.innerHTML = createMarkupLittleCard(products);
      return;
    }

    Notify.success(`We found ${products.length} products`);
    productsListRef.innerHTML = createMarkupBigCard(products);
  } catch (error) {
    console.log(error.message);
  }
}

function onSearchFormInput(event) {
  const value = event.target.value.trim();
  searchFormButtonRef.disabled = !value;
}
